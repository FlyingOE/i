<html>
<head><meta charset="utf-8"></head>
<link rel='icon' type'image/png' href="k.png">
<body>
<script>
{{wasm_exec.js}}
{{k.b64}}
{{rev}}
{{f0.b64}}
{{f1.b64}}
{{f2.b64}}
{{f3.b64}}
{{tk.b64}}
var f = new Object() // memfs
function sa(s){var r=new Uint8Array(new ArrayBuffer(s.length));for(var i=0;i<s.length;i++)r[i]=s.charCodeAt(i);return r}
var kwasm = sa(atob(r))
const go = new Go()

f["rev"] = sa(rev)
f["t.k"] = sa(atob(tk))
f["f0.k"] = sa(atob(f0))
f["f1.k"] = sa(atob(f1))
f["f2.k"] = sa(atob(f2))
f["f3.k"] = sa(atob(f3))

// k\ui (similar to ../../u/s.k, but without http)
w=window;d=document;b=d.body;b.style.margin=0;b.style.padding=0;b.style.overflow='hidden';N=Number;function pd(e){if(e){e.preventDefault();e.stopPropagation()}};
c=d.createElement('canvas');b.appendChild(c);ctx=c.getContext('2d');
function debounce(f,w,i){var t;return function e(){var c=this;var a=arguments;var l=function(){t=null;if(!i)f.apply(c,a);};var n=i&&!t;clearTimeout(t);t=setTimeout(l,w);if(n)f.apply(c,a);}}
function mod(e){return [N(e.shiftKey),N(e.altKey),N(e.ctrlKey)]};
xd=0;yd=0;down=function(e){xd=e.clientX;yd=e.clientY;pd(e)};nomenu=function(e){pd(e)};
up=function(e){pd(e);ui(1,e.button,xd,e.clientX,yd,e.clientY,...mod(e))};
keycode=function(e){var k=e.keyCode;return (e.key.length==1)?e.key.charCodeAt():(k==8)?8:(k==9)?9:(k==13)?13:(k==27)?27:(k==46)?127:(k>32&&k<41)?k-19:null};
key=function(e){var k=keycode(e);if(!k)return;ui(0,k,...mod(e));pd(e);};
wheel=function(e){var x=e.clientX;var y=e.clientY;var m=(e.deltaY>0)?4:(e.deltaY<0)?5:null;if(m)ui(1, m,x,y,x,y,...mod(e))};
size=function(e){c.width=w.innerWidth;c.height=w.innerHeight;ui(2,c.width,c.height);pd(e)};
function ae(x,y,z){x.addEventListener(y,z)};ae(w,'contextmenu',nomenu);ae(w,'mousedown',down);ae(w,'mouseup',up);ae(w,'wheel',wheel);ae(w,'keydown',key);ae(w,'resize',debounce(size,100)); //size()

c.ondragover=function(e){pd(e)}
c.ondrop=function(e){pd(e);if (e.dataTransfer.items){for (var i=0;i<e.dataTransfer.items.length;i++){if(e.dataTransfer.items[i].kind=='file'){var file=e.dataTransfer.items[i].getAsFile();addfile(file)}}}else for(vari=0;i<e.dataTransfer.files.length;i++)addfile(e.dataTransfer.files[i])}
function addfile(x){var r=new FileReader();r.onload=function(){
  console.log("w ", x.name)
  f[x.name]=new Uint8Array(r.result)};r.readAsArrayBuffer(x)}

function hash(s){window.location.hash=encodeURIComponent(s.trim())}
function e(x){ui(7088,x)} // eval(js console)

(async () => {
  const module = await WebAssembly.compile(kwasm.buffer);
  const k = await WebAssembly.instantiate(module, go.importObject);
  go.run(k)
  ui(416, "t.k") // load
  if(window.location.hash.length>1)ui(339,decodeURIComponent(window.location.hash.substr(1)))
  size()
})();

</script>
<body>
</html>
