#include<stdlib.h>
#include<stdio.h>
#include<stddef.h>
#include<malloc.h>
#include<string.h>
#include<math.h>
#define R return
typedef void V;typedef char C;typedef int32_t I;typedef int64_t J;typedef double F;typedef uint32_t uI;typedef uint64_t uJ;
I __builtin_clz(I x){I r;__asm__("bsr %1, %0" : "=r" (r) : "rm" (x) : "cc");R r^31;}
V trap() { exit(1); }
C *MC;I* MI;J* MJ;F *MF;
//F NaN = &((unt64_t)9221120237041090561ull);
V *MT[255];
I ini(I);I bk(I,I);I mk(I,I);I mki(I);I mkf(F);I mkd(I,I);I mkz(I,I);I l2(I,I);V fr(I);V dx(I);V rx(I);V rxn(I,I);V rl(I);I lx(I);I til(I);I seq(I,I,I);I tir(I);I up(I,I,I);I atx(I,I);I cal(I,I);I rev(I);I fst(I);I cut(I,I);I rsh(I,I);I prod(I,I);I take(I,I);I drop(I,I);I use(I);V mv(I,I,I);I cat(I,I);I ucat(I,I);I lcat(I,I);I enl(I);I cnt(I);I typ(I);I not(I);I wer(I);I mtc(I,I);I match(I,I);I fnd(I,I);I fnx(I,I);I exc(I,I);I srt(I);I gdn(I);I grd(I);V msrt(I,I,I,I,I,I);V mrge(I,I,I,I,I,I,I);I gtc(I,I);I gti(I,I);I gtf(I,I);I eqc(I,I);I eqi(I,I);I eqf(I,I);I eqz(I,I);I eqL(I,I);I gtl(I,I);I eql(I,I);I mor(I,I);I les(I,I);I cmp(I,I,I);I nd(I,I,I);I nm(I,I);I add(I,I);I sub(I,I);I mul(I,I);I diw(I,I);V adc(I,I,I);V adi(I,I,I);V adf(I,I,I);V adz(I,I,I);V suc(I,I,I);V sui(I,I,I);V suf(I,I,I);V suz(I,I,I);V muc(I,I,I);V mui(I,I,I);V muf(I,I,I);V muz(I,I,I);V dic(I,I,I);V dii(I,I,I);V dif(I,I,I);V diz(I,I,I);I abs(I);I neg(I);I sqr(I);V abc(I,I);V abi(I,I);V abf(I,I);V abz(I,I);V nec(I,I);V nei(I,I);V nef(I,I);V nez(I,I);V sqc(I,I);V sqi(I,I);V sqf(I,I);V sqz(I,I);I zre(I);I zim(I);I zri(I,I);I crAZ(I);I craz(I);V nag(I);V nac(I);V nai(I);V naf(I);V naz(I);V nas(I);V nal(I);I drv(I,I);I ecv(I);I epv(I);I ovv(I);I scv(I);I ech(I,I);I ecp(I,I);I ovr(I,I);I scn(I,I);I ecd(I,I,I);I epi(I,I,I);I val(I);I evl(I);I xx1(I);I xx2(I,I);I str(I);I grp(I);I unq(I);I flr(I);I cst(I,I);I min(I,I);I max(I,I);I sadv(I);
I ini(I x0){I x1=0;I x2=0;MJ[0>>3]=(J)289360742959022336;MI[128>>2]=(I)x0;x1=256;x2=8;while(((uI)x2<(uI)x0)){MI[(4*x2)>>2]=(I)x1;x1=(x1*2);x2=(x2+1);}R x0;}
I bk(I x0,I x1){I x2=0;x2=(32-(__builtin_clz((7+((x1*((I)MC[x0])))))));if(((uI)x2<(uI)4)){R 4;}R x2;}
I mk(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;x2=bk(x0,x1);x3=(4*x2);while(!(MI[x3>>2])){x3=(x3+4);}if((128==x3)){trap();}x4=MI[x3>>2];MI[x3>>2]=(I)MI[x4>>2];x5=(x3-4);while(((uI)x5>=(uI)((4*x2)))){x6=(x4+((1<<(((uI)x5>>(uI)2)))));MI[x6>>2]=(I)MI[x5>>2];MI[x5>>2]=(I)x6;x5=(x5-4);}MI[x4>>2]=(I)(x1|((x0<<29)));MI[(x4+4)>>2]=(I)1;R x4;}
I mki(I x0){I x1=0;x1=mk(2,1);MI[(x1+8)>>2]=(I)x0;R x1;}
I mkf(F x0){I x1=0;x1=mk(3,1);MF[(x1+8)>>3]=(F)x0;R x1;}
I mkd(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x2==x5))){trap();}if((((x3==1))&(((uI)x6>(uI)1)))){x0=take(x0,x6);x3=x6;x4=(x0+8);}if((((x6==1))&(((uI)x3>(uI)1)))){x1=take(x1,x3);x6=x3;x7=(x1+8);}if(!((x3==x6))){trap();}x8=mk(7,2);MI[(x8+8)>>2]=(I)x0;MI[(x8+12)>>2]=(I)x1;R x8;}
I mkz(I x0,I x1){I x2=0;x2=mkd(x0,x1);MI[x2>>2]=(I)(2|((6<<29)));R x2;}
I l2(I x0,I x1){I x2=0;x2=mk(6,2);MI[(x2+8)>>2]=(I)x0;MI[(x2+12)>>2]=(I)x1;R x2;}
V fr(I x0){I x1=0;I x2=0;I x3=0;I x4=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);x4=(4*(bk(x1,x2)));MI[x0>>2]=(I)MI[x4>>2];MI[x4>>2]=(I)x0;;}
V dx(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;if(((uI)x0>(uI)255)){x1=MI[(x0+4)>>2];MI[(x0+4)>>2]=(I)(x1-1);if((1==x1)){x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(((uI)x2>(uI)4)){for(x5=0;x5<x3;x5++){dx(MI[(x4+((4*x5)))>>2]);}}fr(x0);}};}
V rx(I x0){rxn(x0,1);;}
V rxn(I x0,I x1){if(((uI)x0>(uI)255)){x0=(x0+4);MI[x0>>2]=(I)(x1+(MI[x0>>2]));};}
V rl(I x0){I x1=0;I x2=0;I x3=0;I x4=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);for(x4=0;x4<x2;x4++){rx(MI[x3>>2]);x3=(x3+4);};}
I lx(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if((x1==6)){R x0;}x4=mk(6,x2);x5=(x4+8);for(x6=0;x6<x2;x6++){rx(x0);MI[x5>>2]=(I)atx(x0,mki(x6));x5=(x5+4);}dx(x0);R x4;}
I til(I x0){I x1=0;I x2=0;I x3=0;I x4=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if(!((2==x1))){trap();}x4=MI[x3>>2];dx(x0);if((x4<0)){R tir(-(x4));}R seq(0,x4,1);}
I seq(I x0,I x1,I x2){I x3=0;I x4=0;I x5=0;x3=mk(2,x1);x4=(8+x3);for(x5=0;x5<x1;x5++){MI[x4>>2]=(I)(x2*((x5+x0)));x4=(x4+4);}R x3;}
I tir(I x0){I x1=0;I x2=0;I x3=0;x1=mk(2,x0);x2=(4+((x1+((4*x0)))));for(x3=0;x3<x0;x3++){MI[x2>>2]=(I)x3;x2=(x2-4);}R x1;}
I up(I x0,I x1,I x2){I x3=0;I x4=0;I x5=0;I x6=0;x3=mk((x1+1),x2);x4=(x0+8);x5=(x3+8);switch(x1){case 1:for(x6=0;x6<x2;x6++){MI[x5>>2]=(I)(I)MC[(x4+x6)];x5=(x5+4);}break;case 2:for(x6=0;x6<x2;x6++){MF[x5>>3]=(F)(F)MI[x4>>2];x5=(x5+8);x4=(x4+4);}break;default:trap();}dx(x0);R x3;}
I atx(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;I x13=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!(x2)){R cal(x0,enl(x1));}if(!((x5==2))){trap();}x8=mk(x2,x6);x9=(x8+8);x10=(I)MC[x2];x11=(x2+128);for(x13=0;x13<x6;x13++){x12=MI[x7>>2];if(((uI)x12<(uI)x3)){mv(x9,(x4+((x10*x12))),x10);}else{((V(*)(I))MT[x11])(x9);}x9=(x9+x10);x7=(x7+4);}if(((uI)x2>(uI)4)){rl(x8);}if((x6==1)){if((x2==6)){rx(MI[(x8+8)>>2]);dx(x8);x8=MI[(x8+8)>>2];}}dx(x0);dx(x1);R x8;}
I cal(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x5==6))){trap();}if((x6==1)){if(((sadv(x0))|(sadv((x0-128))))){R ((I(*)(I))MT[x0])(fst(x1));}}if(((uI)x0<(uI)128)){if(!((x6==1))){trap();}R ((I(*)(I))MT[x0])(fst(x1));}if(((uI)x0<(uI)256)){if(!((x6==2))){trap();}rl(x1);dx(x1);R ((I(*)(I,I))MT[x0])(MI[x7>>2],MI[(x7+4)>>2]);}if((x3==2)){rl(x0);dx(x0);x8=MI[x4>>2];switch(x6){case 1:R ((I(*)(I,I))MT[x8])(fst(x1),MI[(x4+4)>>2]);break;case 2:x8=(x8+128);rl(x1);dx(x1);R ((I(*)(I,I,I))MT[x8])(MI[x7>>2],MI[(x7+4)>>2],MI[(x4+4)>>2]);break;default:trap();}}trap();R x0;}
I rev(I x0){I x1=0;I x2=0;I x3=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if(!(x2)){R x0;}R atx(x0,tir(x2));}
I fst(I x0){I x1=0;I x2=0;I x3=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if((x1==7)){rx((12+x0));dx(x0);R fst((12+x0));}R atx(x0,mki(0));}
I cut(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x2==2))){trap();}if((x3==1)){x8=drop(x1,MI[x4>>2]);dx(x0);R x8;}x8=mk(6,x3);x9=(x8+8);for(x12=0;x12<x3;x12++){x10=MI[x4>>2];x11=MI[(x4+4)>>2];if((x12==((x3-1)))){x11=x6;}if(((uI)x11<(uI)x10)){trap();}rx(x1);MI[x9>>2]=(I)atx(x1,seq(x10,(x11-x10),1));x4=(x4+4);x9=(x9+4);}dx(x0);dx(x1);R x8;}
I rsh(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x2==2))){trap();}x8=prod(x4,x3);x9=take(x1,x8);if((x3==1)){dx(x0);R x9;}x3=(x3-1);x10=(x4+((4*x3)));for(x12=0;x12<x3;x12++){x11=MI[x10>>2];x8=((uI)x8/(uI)x11);x8=prod(x4,(x3-x12));x9=cut(seq(0,x8,x11),x9);x10=(x10-4);}dx(x0);R x9;}
I prod(I x0,I x1){I x2=0;I x3=0;x2=1;for(x3=0;x3<x1;x3++){x2=(x2*(MI[x0>>2]));x0=(x0+4);}R x2;}
I take(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=til(mki(x1));x6=(x5+8);if(((uI)x3<(uI)x1)){for(x7=0;x7<x1;x7++){MI[(x6+((4*x7)))>>2]=(I)((uI)x7%(uI)x3);}}R atx(x0,x5);}
I drop(I x0,I x1){I x2=0;I x3=0;I x4=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(((uI)x1>(uI)x3)){trap();}R atx(x0,seq(x1,(x3-x1),1));}
I use(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;if((1==(MI[(x0+4)>>2]))){R x0;}x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);x4=mk(x1,x2);x5=(x4+8);mv(x5,x3,(x2*((I)MC[x1])));dx(x0);R x4;}
V mv(I x0,I x1,I x2){I x3=0;for(x3=0;x3<x2;x3++){MC[(x0+x3)]=(C)MC[(x1+x3)];};}
I cat(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(((!(x2))|(!(x5)))){trap();}if((x2==x5)){R ucat(x0,x1);}if((x2==6)){R lcat(x0,x1);}trap();R x0;}
I ucat(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(((uI)x2>(uI)4)){rl(x0);}if(((uI)x2>(uI)5)){x8=mkd((x0+8),(x0+12));dx(x0);dx(x1);R x8;}x8=mk(x2,(x3+x6));x9=(I)MC[x2];mv((x8+8),x4,(x9*x3));mv((x8+((8+((x9*x3))))),x7,(x9*x6));dx(x0);dx(x1);R x8;}
I lcat(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(((uI)(bk(x2,x3))<(uI)(bk(x2,(x3+1))))){x5=mk(x2,(x3+1));rl(x0);dx(x0);mv((x5+8),x4,(4*x3));x0=x5;x4=(x0+8);}MI[(x4+((4*x3)))>>2]=(I)x1;MI[x0>>2]=(I)(((x3+1))|((6<<29)));R x0;}
I enl(I x0){R lcat(mk(6,0),x0);}
I cnt(I x0){I x1=0;I x2=0;I x3=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);dx(x0);R mki(x2);}
I typ(I x0){I x1=0;I x2=0;I x3=0;I x4=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);x4=mk(2,1);MI[(8+x4)>>2]=(I)x1;dx(x0);R x4;}
I not(I x0){R eql(x0,mki(0));}
I wer(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if(!((x1==2))){trap();}x4=0;for(x7=0;x7<x2;x7++){x4=(x4+(MI[x3>>2]));x3=(x3+4);}x3=(8+x0);x5=mk(2,x4);x6=(x5+8);for(x7=0;x7<x2;x7++){x8=MI[x3>>2];for(x9=0;x9<x8;x9++){MI[x6>>2]=(I)x7;x6=(x6+4);}x3=(x3+4);}dx(x0);R x5;}
I mtc(I x0,I x1){I x2=0;x2=mk(2,1);MI[(x2+8)>>2]=(I)match(x0,x1);dx(x0);dx(x1);R x2;}
I match(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;if((x0==x1)){R 1;}if(!(((MI[x0>>2])==(MI[x1>>2])))){R 0;}x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=(x1+8);x6=0;switch(x2){case 0:R 1;break;case 1:x7=x3;break;case 2:x7=(x3<<2);break;case 3:x7=(x3<<3);break;case 4:x7=(x3<<4);break;default:for(x8=0;x8<x3;x8++){if(!(match(MI[x4>>2],MI[x5>>2]))){R 0;}x4=(x4+4);x5=(x5+4);}R 1;}for(x8=0;x8<x7;x8++){if(!(((MC[(x4+x8)])==(MC[(x5+x8)])))){R 0;}}R 1;}
I fnd(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x2==x5))){trap();}x8=mk(2,x6);x9=(x8+8);x10=(I)MC[x5];for(x11=0;x11<x6;x11++){MI[x9>>2]=(I)fnx(x0,x7);x9=(x9+4);x7=(x7+x10);}dx(x0);dx(x1);R x8;}
I fnx(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=(8+x2);x6=(I)MC[x2];for(x7=0;x7<x3;x7++){if(((I(*)(I,I))MT[x5])(x4,x1)){R x7;}x4=(x4+x6);}R x3;}
I exc(I x0,I x1){rx(x0);R atx(x0,wer(eql(mki(((MI[x1>>2])&536870911)),fnd(x1,x0))));}
I srt(I x0){rx(x0);R atx(x0,grd(x0));}
I gdn(I x0){R rev(grd(x0));}
I grd(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);x4=seq(0,x2,1);x5=seq(0,x2,1);x6=(x4+8);msrt((x5+8),x6,0,x2,x3,x1);dx(x0);dx(x5);R x4;}
V msrt(I x0,I x1,I x2,I x3,I x4,I x5){I x6=0;if(((uI)((x3-x2))>=(uI)2)){x6=((uI)((x3+x2))/(uI)2);msrt(x1,x0,x2,x6,x4,x5);msrt(x1,x0,x6,x3,x4,x5);mrge(x0,x1,x2,x3,x6,x4,x5);};}
V mrge(I x0,I x1,I x2,I x3,I x4,I x5,I x6){I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;x7=x2;x8=x4;x9=(I)MC[x6];x10=x2;while(((uI)x10<(uI)x3)){x11=((uI)x7>=(uI)x4);if(!(x11)){if(((uI)x8>=(uI)x3)){x11=0;}else{x11=((I(*)(I,I))MT[x6])((x5+((x9*(MI[(x0+((x7<<2)))>>2])))),(x5+((x9*(MI[(x0+((x8<<2)))>>2])))));}}if(x11){x12=x8;x8=(x8+1);}else{x12=x7;x7=(x7+1);}MI[(x1+((x10<<2)))>>2]=(I)MI[(x0+((x12<<2)))>>2];x10=(x10+1);};}
I gtc(I x0,I x1){R ((MC[x0])>(MC[x1]));}
I gti(I x0,I x1){R ((MI[x0>>2])>(MI[x1>>2]));}
I gtf(I x0,I x1){R ((MF[x0>>3])>(MF[x1>>3]));}
I eqc(I x0,I x1){R ((MC[x0])==(MC[x1]));}
I eqi(I x0,I x1){R ((MI[x0>>2])==(MI[x1>>2]));}
I eqf(I x0,I x1){R ((MF[x0>>3])==(MF[x1>>3]));}
I eqz(I x0,I x1){if(eqf(x0,x1)){R eqf((x0+8),(x1+8));}R 0;}
I eqL(I x0,I x1){R match(MI[x0>>2],MI[x1>>2]);}
I gtl(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;x0=MI[x0>>2];x1=MI[x1>>2];x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=((uI)(MI[x1>>2])>>(uI)29);x6=((MI[x1>>2])&536870911);x7=(8+x1);if(!((x2==x5))){R ((uI)x2>(uI)x5);}x8=x3;if(((uI)x6<(uI)x3)){x8=x6;}x9=(I)MC[x2];for(x12=0;x12<x8;x12++){x10=(x4+((x12*x9)));x11=(x7+((x12*x9)));if(((I(*)(I,I))MT[x2])(x10,x11)){R 1;}if(((I(*)(I,I))MT[x2])(x11,x10)){R 0;}}R ((uI)x3>(uI)x6);}
I eql(I x0,I x1){R cmp(x0,x1,1);}
I mor(I x0,I x1){R cmp(x0,x1,0);}
I les(I x0,I x1){R cmp(x1,x0,0);}
I cmp(I x0,I x1,I x2){I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;I x13=0;x3=((uI)(MI[x0>>2])>>(uI)29);x4=((MI[x0>>2])&536870911);x5=(8+x0);x6=((uI)(MI[x1>>2])>>(uI)29);x7=((MI[x1>>2])&536870911);x8=(8+x1);if(((uI)x3>=(uI)5)){trap();}if(((uI)x6>=(uI)5)){trap();}while(((uI)x3<(uI)x6)){x0=up(x0,x3,x4);x3=(x3+1);}while(((uI)x6<(uI)x3)){x1=up(x1,x6,x7);x6=(x6+1);}x5=(x0+8);x8=(x1+8);if(!((x3==x6))){trap();}if((((x4==1))&(((uI)x7>(uI)1)))){x0=take(x0,x7);x4=x7;x5=(x0+8);}if((((x7==1))&(((uI)x4>(uI)1)))){x1=take(x1,x4);x7=x4;x8=(x1+8);}if(!((x4==x7))){trap();}x9=x3;if(x2){x9=(x9+8);}x10=(I)MC[x3];x11=mk(2,x4);x12=(x11+8);for(x13=0;x13<x4;x13++){MI[x12>>2]=(I)((I(*)(I,I))MT[x9])(x5,x8);x5=(x5+x10);x8=(x8+x10);x12=(x12+4);}dx(x0);dx(x1);R x11;}
I nd(I x0,I x1,I x2){I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;I x9=0;I x10=0;I x11=0;I x12=0;I x13=0;x3=((uI)(MI[x0>>2])>>(uI)29);x4=((MI[x0>>2])&536870911);x5=(8+x0);x6=((uI)(MI[x1>>2])>>(uI)29);x7=((MI[x1>>2])&536870911);x8=(8+x1);if(((uI)x3>=(uI)5)){trap();}if(((uI)x6>=(uI)5)){trap();}while(((uI)x3<(uI)x6)){x0=up(x0,x3,x4);x3=(x3+1);}while(((uI)x6<(uI)x3)){x1=up(x1,x6,x7);x6=(x6+1);}x5=(x0+8);x8=(x1+8);if(!((x3==x6))){trap();}if((((x4==1))&(((uI)x7>(uI)1)))){x0=take(x0,x7);x4=x7;x5=(x0+8);}if((((x7==1))&(((uI)x4>(uI)1)))){x1=take(x1,x4);x7=x4;x8=(x1+8);}if(!((x4==x7))){trap();}x9=(I)MC[x3];x10=(x2+x3);x11=mk(x3,x4);x12=(x11+8);for(x13=0;x13<x4;x13++){((V(*)(I,I,I))MT[x10])(x5,x8,x12);x5=(x5+x9);x8=(x8+x9);x12=(x12+x9);}dx(x0);dx(x1);R x11;}
I nm(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=use(x0);x6=(x5+8);x7=(I)MC[x2];x1=(x1+x2);for(x8=0;x8<x3;x8++){((V(*)(I,I))MT[x1])(x4,x6);x4=(x4+x7);x6=(x6+x7);}if((x2==4)){if((x1==19)){R zre(x5);}}R x5;}
I add(I x0,I x1){R nd(x0,x1,143);}
I sub(I x0,I x1){R nd(x0,x1,147);}
I mul(I x0,I x1){R nd(x0,x1,151);}
I diw(I x0,I x1){R nd(x0,x1,155);}
V adc(I x0,I x1,I x2){MC[x2]=(C)((MC[x0])+(MC[x1]));;}
V adi(I x0,I x1,I x2){MI[x2>>2]=(I)((MI[x0>>2])+(MI[x1>>2]));;}
V adf(I x0,I x1,I x2){MF[x2>>3]=(F)((MF[x0>>3])+(MF[x1>>3]));;}
V adz(I x0,I x1,I x2){adf(x0,x1,x2);adf((x0+8),(x1+8),(x2+8));;}
V suc(I x0,I x1,I x2){MC[x2]=(C)((MC[x0])-(MC[x1]));;}
V sui(I x0,I x1,I x2){MI[x2>>2]=(I)((MI[x0>>2])-(MI[x1>>2]));;}
V suf(I x0,I x1,I x2){MF[x2>>3]=(F)((MF[x0>>3])-(MF[x1>>3]));;}
V suz(I x0,I x1,I x2){suf(x0,x1,x2);suf((x0+8),(x1+8),(x2+8));;}
V muc(I x0,I x1,I x2){MC[x2]=(C)((MC[x0])*(MC[x1]));;}
V mui(I x0,I x1,I x2){MI[x2>>2]=(I)((MI[x0>>2])*(MI[x1>>2]));;}
V muf(I x0,I x1,I x2){MF[x2>>3]=(F)((MF[x0>>3])*(MF[x1>>3]));;}
V muz(I x0,I x1,I x2){MF[x2>>3]=(F)((((MF[x0>>3])*(MF[(x0+8)>>3])))-(((MF[x1>>3])*(MF[(x1+8)>>3]))));MF[(x2+8)>>3]=(F)((((MF[x0>>3])*(MF[(x1+8)>>3])))+(((MF[(x0+8)>>3])*(MF[x1>>3]))));;}
V dic(I x0,I x1,I x2){MC[x2]=(C)((MC[x0])/(MC[x1]));;}
V dii(I x0,I x1,I x2){MI[x2>>2]=(I)((uI)(MI[x0>>2])/(uI)(MI[x1>>2]));;}
V dif(I x0,I x1,I x2){MF[x2>>3]=(F)((MF[x0>>3])/(MF[x1>>3]));;}
V diz(I x0,I x1,I x2){F x3=.0;F x4=.0;F x5=.0;F x6=.0;F x7=.0;F x8=.0;x3=MF[x0>>3];x4=MF[(x0+8)>>3];x5=MF[x1>>3];x6=MF[(x1+8)>>3];if(((fabs(x5))>=(fabs(x6)))){x7=(x6/x5);x8=(x5+((x7*x6)));MF[x2>>3]=(F)(((x3+((x4*x7))))/x8);MF[(x2+8)>>3]=(F)(((x4-((x3*x7))))/x8);}else{x7=(x5/x6);x8=(x6+((x7*x5)));MF[x2>>3]=(F)(((x3*((x7+x4))))/x8);MF[(x2+8)>>3]=(F)(((x4*((x7-x3))))/x8);};}
I abs(I x0){R nm(x0,15);}
I neg(I x0){R nm(x0,19);}
I sqr(I x0){R nm(x0,27);}
V abc(I x0,I x1){I x2=0;x2=(I)MC[x0];if(craz(x2)){MC[x1]=(C)(C)(x2-32);}else{MC[x1]=(C)(C)x2;};}
V abi(I x0,I x1){I x2=0;x2=MI[x0>>2];if((x2<0)){MI[x1>>2]=(I)(0-x2);}else{MI[x1>>2]=(I)x2;};}
V abf(I x0,I x1){MF[x1>>3]=(F)fabs(MF[x0>>3]);;}
V abz(I x0,I x1){F x2=.0;F x3=.0;x2=MF[x0>>3];x3=MF[(x0+8)>>3];MF[x1>>3]=(F)sqrt((x2*((x2+((x3*x3))))));;}
V nec(I x0,I x1){I x2=0;x2=(I)MC[x0];if(crAZ(x2)){MC[x1]=(C)(C)(x2+32);}else{MC[x1]=(C)(C)x2;};}
V nei(I x0,I x1){MI[x1>>2]=(I)(0-(MI[x0>>2]));;}
V nef(I x0,I x1){MF[x1>>3]=(F)-(MF[x0>>3]);;}
V nez(I x0,I x1){MF[x1>>3]=(F)-(MF[x0>>3]);MF[(x1+8)>>3]=(F)-(MF[(x0+8)>>3]);;}
V sqc(I x0,I x1){trap();;}
V sqi(I x0,I x1){trap();;}
V sqf(I x0,I x1){MF[x1>>3]=(F)sqrt(MF[x0>>3]);;}
V sqz(I x0,I x1){MF[x1>>3]=(F)MF[x0>>3];MF[(x1+8)>>3]=(F)-(MF[(x0+8)>>3]);;}
I zre(I x0){R zri(x0,0);}
I zim(I x0){R zri(x0,8);}
I zri(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if((x2==4)){trap();}x5=mk(3,x3);x6=(x5+8);x4=(x4+x1);for(x7=0;x7<x3;x7++){MF[x6>>3]=(F)MF[x4>>3];x6=(x6+8);x4=(x4+16);}dx(x0);R x5;}
I crAZ(I x0){if(((uI)x0>(uI)64)){if(((uI)x0<(uI)91)){R 1;}}R 0;}
I craz(I x0){if(((uI)x0>(uI)96)){if(((uI)x0<(uI)123)){R 1;}}R 0;}
V nag(I x0){MI[x0>>2]=(I)0;;}
V nac(I x0){MC[x0]=(C)(C)32;;}
V nai(I x0){MI[x0>>2]=(I)-2147483648;;}
V naf(I x0){MF[x0>>3]=(F)NAN;;}
V naz(I x0){naf(x0);naf((x0+8));;}
V nas(I x0){MI[x0>>2]=(I)mk(1,0);MI[(4+(MI[x0>>2]))>>2]=(I)0;;}
V nal(I x0){MI[x0>>2]=(I)0;;}
I drv(I x0,I x1){I x2=0;x2=mk(0,2);MI[(x2+8)>>2]=(I)x0;MI[(x2+12)>>2]=(I)x1;R x2;}
I ecv(I x0){R drv(40,x0);}
I epv(I x0){R drv(41,x0);}
I ovv(I x0){R drv(123,x0);}
I scv(I x0){R drv(91,x0);}
I ech(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x0=lx(x0);x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);x5=mk(6,x3);x6=(x5+8);rl(x0);if(((uI)x1<(uI)256)){if(((uI)x1>(uI)127)){x1=(x1-128);}}for(x7=0;x7<x3;x7++){rx(x1);MI[x6>>2]=(I)atx(x1,MI[x4>>2]);x4=(x4+4);x6=(x6+4);}dx(x0);dx(x1);R x5;}
I ecp(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(!(x3)){dx(x1);R fst(x0);}rxn(x0,(-1+((2*x3))));rxn(x1,(x3-1));x5=fst(x0);x6=(x3-1);for(x7=0;x7<x6;x7++){x5=cat(x5,cal(x1,l2(atx(x0,mki((1+x7))),atx(x0,mki(x7)))));}dx(x0);dx(x1);R x5;}
I ovr(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(!(x3)){dx(x1);R fst(x0);}rxn(x0,x3);rxn(x1,(x3-1));x5=fst(x0);x6=(x3-1);for(x7=0;x7<x6;x7++){x5=cal(x1,l2(x5,atx(x0,mki((x7+1)))));}dx(x0);dx(x1);R x5;}
I scn(I x0,I x1){I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;I x7=0;I x8=0;x2=((uI)(MI[x0>>2])>>(uI)29);x3=((MI[x0>>2])&536870911);x4=(8+x0);if(!(x3)){dx(x1);R fst(x1);}rxn(x0,x3);rxn(x1,(x3-1));x5=fst(x0);rx(x5);x6=enl(x5);x7=(x3-1);for(x8=0;x8<x7;x8++){x5=cal(x1,l2(x5,atx(x0,mki((1+x8)))));rx(x5);x6=lcat(x6,x5);}dx(x5);dx(x0);dx(x1);R x6;}
I ecd(I x0,I x1,I x2){trap();R x0;}
I epi(I x0,I x1,I x2){trap();R x0;}
I val(I x0){I x1=0;I x2=0;I x3=0;I x4=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);switch(x1){case 5:x4=evl(x0);break;case 6:rx((x0+12));x4=(x0+12);dx(x0);break;default:trap();}R x4;}
I evl(I x0){I x1=0;I x2=0;I x3=0;I x4=0;I x5=0;I x6=0;x1=((uI)(MI[x0>>2])>>(uI)29);x2=((MI[x0>>2])&536870911);x3=(8+x0);if(!((x1==6))){R x0;}if((x2==0)){R x0;}if((x2==1)){R fst(x0);}rl(x0);x4=mk(6,x2);x5=(x4+8);for(x6=0;x6<x2;x6++){MI[x5>>2]=(I)evl(MI[x3>>2]);x5=(x5+4);x3=(x3+4);}x5=(x4+8);dx(x0);if((2==x2)){rl(x4);dx(x4);R atx(MI[x5>>2],MI[(x5+4)>>2]);}if(!((3==x2))){trap();}rx(MI[x5>>2]);R cal(MI[x5>>2],drop(x4,1));}
I xx1(I x0){trap();R x0;}
I xx2(I x0,I x1){trap();R x0;}
I str(I x0){trap();R x0;}
I grp(I x0){trap();R x0;}
I unq(I x0){trap();R x0;}
I flr(I x0){trap();R x0;}
I cst(I x0,I x1){trap();R x0;}
I min(I x0,I x1){trap();R x0;}
I max(I x0,I x1){trap();R x0;}
I sadv(I x0){R (x0==39)?1:(x0==47)?1:(x0==92)?1:0;}
V mt_init(){MT[1]=gtc;MT[2]=gti;MT[3]=gtf;MT[4]=gtl;MT[5]=gtl;MT[9]=eqc;MT[10]=eqi;MT[11]=eqf;MT[12]=eqz;MT[13]=eqL;MT[14]=eqL;MT[16]=abc;MT[17]=abi;MT[18]=abf;MT[19]=abz;MT[20]=nec;MT[21]=nei;MT[22]=nef;MT[23]=nez;MT[28]=sqc;MT[29]=sqi;MT[30]=sqf;MT[31]=sqz;MT[33]=til;MT[34]=xx1;MT[35]=cnt;MT[36]=str;MT[37]=sqr;MT[38]=wer;MT[39]=epv;MT[40]=ech;MT[41]=ecp;MT[42]=fst;MT[43]=abs;MT[44]=enl;MT[45]=neg;MT[46]=val;MT[60]=grd;MT[61]=grp;MT[62]=gdn;MT[63]=unq;MT[64]=typ;MT[91]=scn;MT[92]=xx1;MT[93]=xx1;MT[94]=srt;MT[95]=flr;MT[123]=ovr;MT[124]=rev;MT[125]=xx1;MT[126]=not;MT[128]=nag;MT[129]=nac;MT[130]=nai;MT[131]=naf;MT[132]=naz;MT[133]=nas;MT[134]=nal;MT[144]=adc;MT[145]=adi;MT[146]=adf;MT[147]=adz;MT[148]=suc;MT[149]=sui;MT[150]=suf;MT[151]=suz;MT[152]=muc;MT[153]=mui;MT[154]=muf;MT[155]=muz;MT[156]=dic;MT[157]=dii;MT[158]=dif;MT[159]=diz;MT[161]=mkd;MT[162]=xx2;MT[163]=rsh;MT[164]=cst;MT[165]=diw;MT[166]=min;MT[167]=ecv;MT[168]=ecd;MT[169]=epi;MT[170]=mul;MT[171]=add;MT[172]=cat;MT[173]=sub;MT[174]=cal;MT[175]=ovv;MT[188]=les;MT[189]=eql;MT[190]=mor;MT[191]=fnd;MT[192]=atx;MT[220]=scv;MT[221]=xx1;MT[222]=exc;MT[223]=cut;MT[252]=max;MT[253]=xx2;MT[254]=mtc;}

V Dump(I x, I n) {
	I p = x>>2;
	printf("\n%08x  ", x);
	for (I i=0; i<n; i++) {
		printf(" %08x", MI[p+i]);
		if ((i > x) && ((i+1)%8 == 0))      printf("\n%08x  ", x+4*i+4);
		else if ((i > 0) && ((i+1)%4 == 0)) printf(" ");
	}
	printf("\n");
}
V kst(I x) {
	I i, j, y, m, tof;
	I t = ((uI)MI[x>>2])>>29;
	I n = ((uI)MI[x>>2])&536870911;
	switch(t){
	case 0:
		if(x<128)       printf("%c", x);
		else if (x<256) printf("%c", x-128);
		else { printf("kst(x=%x)"); trap(); }
		break;
	case 1:
		printf("\"");
		for(i=0;i<n;i++) printf("%c", MC[8+x+i]);
		printf("\"");
		break;
	case 2:
		x = 2 + (x>>2);
		for(i=0;i<n;i++) {
			if (i>0)  printf(" ");
			if (MI[x+i] == -2147483648) printf("0N");
			else                        printf("%d", MI[x+i]);
		}
		break;
	case 3:
		tof = 1;
		x = 1 + (x>>3);
		for(i=0;i<n;i++) {
			if (i>0)  printf(" ");
			if (MF[x+i] != MF[x+i]) { printf("0n"); tof = 0; } else printf("%g", MF[x+i]);
			if (MF[x+i] != (F)(I)MF[x+i]) tof = 0;
		}
		if(tof) printf("f");
		break;
	case 4:
		x = 1 + (x>>3);
		for(i=0;i<2*n;i++) {
			if (i%2 == 0) printf("i");
			else if (i>0) printf(" ");
			if (MF[x+i] != MF[x+i]) printf("0n"); else printf("%g", MF[x+i]);
		}
	case 5:
		x = 2 + (x>>2);
		for(i=0;i<n;i++) {
			printf("%c", 96);
			y = MI[x+i];
			m = MI[y>>2]&536870911;
			for(j=0;j<m;j++) printf("%c", MC[8+y+j]);
		}
		break;
	case 6:
		x = 2 + (x>>2);
		printf("(");
		for(i=0;i<n;i++) {
			if(i>0) printf(";");
			kst(MI[x+i]);
		}
		printf(")");
		break;
	default:
		printf("nyi: kst %x t=%d\n", x, t);trap();
	}
}
V O(I x) { kst(x); printf("\n"); }
I parseNoun(C *s);
I findChr(C *s, I n, C p) {
	I i;
	for (i=0; i<n; i++) if (s[i] == p) return i;
	R n;
}
I chrVector(C *s) {
	I i, x;
	I n = strlen(s);
	s++; n-=2;
	if(n<0) trap();
	x = mk(1, n);
	for (i=0; i<n; i++) MC[8+x+i] = s[i];
	R x;
}
I lstVector(C *s) {
	I r[9];
	I l = 0;
	I a = 0;
	I rn = 0;
	I i;
	C p;
	I n = strlen(s);
	if ((n == 0) || s[n-1] != ')') { printf("parse list: %s???\n", s); trap(); }
	if (n == 1) return mk(6, 0);
	s[n-1] = 0; n--;
	for (i=0; i<n; i++) {
		p = s[i];
		if (p=='(') l++;
		else if (p==')') {
			l--;
			if (l<0) { printf(")"); trap(); }
		} else if (l==0 && p == ';') {
			s[i] = 0;
			r[rn++] = parseNoun(s+a);
			if (r[rn-1] == 0) { printf("null element"); trap(); }
			a = i + 1;
			if (rn==8) { printf("list limit"); trap(); }
		}
	}
	r[rn++] = parseNoun(s+a);
	l = mk(6, rn);
	for (i=0;i<rn;i++) MI[2+(l>>2)+i] = r[i];
	R l;
}
I symVector(C *s) {
	I i, j, x, y, m;
	I n = strlen(s);
	I ns = 0;
	C *p;
	for (i=0;i<n;i++) if(s[i] == 96) ns++;
	x = mk(5, ns);
	s++;n--;
	for (i=0;i<ns;i++) {
		m = findChr(s, n, 96);
		y = mk(1, m);
		for (j=0;j<m;j++) MC[8+y+j] = s[j];
		MI[2+i+(x>>2)] = y;
		s += m+1; n -= m+1;
	}
	R x;
}
I numVector(C *s) {
	I n = strlen(s);
	I x, i;
	F fv[8];
	I iv[8];
	C *p;
	I isf = (strchr(s, '.') != NULL);
	p = strtok(s, " ");
	n = 0;
	while(p != NULL) {
		if (n==8) break;
		if (isf)  fv[n++] = atof(p);
		else      iv[n++] = atoi(p);
 		p = strtok(NULL, " ");
	}
	if (isf) {
		x = mk(3, n);
		for (i=0; i<n; i++) MF[i+1+(x>>3)] = fv[i];
	} else {
		x = mk(2, n);
		for (i=0; i<n; i++) MI[i+2+(x>>2)] = iv[i];
	}
	R x;
}
I parseNoun(C *s) {
	I i;
	I n = strlen(s);
	for (i=n-1; i>=0; i--) { if(s[i]==' ') s[i] = 0; else break; }
	C c = s[0];
	if (c == '"')                return chrVector(s);
	if (c == 96)                 return symVector(s);
	if (c >= '0' && s[0] <= '9') return numVector(s);
	if (c == '(')                return lstVector(s+1);
	if (strchr(":+-*%&|<>=!~,^#_$?@.'/\\", c) != NULL) { if (s[1] == ':') return c; return 128+c; }
	return numVector(s);
}
#define M0 16
V runtest() {
	I x;
	C buf[128];
	C *p;
	while (fgets(buf, 128, stdin) != NULL) {
		if ((p=strstr(buf, " /"))==NULL) { trap(); }
		*p = 0;
		memset(MC, 0, 1<<M0);
		ini(16);
		O(evl(parseNoun(buf)));
	}
}
I main(int args, C **argv){
	mt_init();
	MC=malloc(1<<M0);MI=(I*)MC;MJ=(J*)MC;MF=(F*)MC;
	if ((args == 2) && (!strcmp(argv[1], "t"))) {runtest(); exit(0);}
	memset(MC, 0, 1<<M0);
	ini(16);
	I x = parseNoun(argv[1]);
	O(evl(x));
}
