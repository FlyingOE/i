# Description
#  k interpreter written in go.
#
# Repository
#  https://github.com/ktye/i
#
# TIO-version
#  https://github.com/ktye/i/blob/master/_/tio
#
# Sample program
#  hello.k
#
# Requirements for building the tio version:
#  go-1.13
#  ../../k.go must exist (should, if this is a git checkout)
#  git (for compiling the revision into the binary)
# Then run
#  make -f readme tio

build:
	# install go-1.13
	cp ../../k.go .
	echo -e "module github.com/ktye/i/_/k\n\ngo 1.13" > go.mod
	GOPATH="" GO111MODULE=on go build -ldflags="-s -w"
	# there should now be a native executable k(.exe)

tio: build
	GOPATH="" GO111MODULE=on GOOS=linux GOARCH=amd64 go build -ldflags="-s -w -X main.V=$(shell git rev-parse --short HEAD)"
	# tio executable: k
