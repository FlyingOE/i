# Description
#  k interpreter written in go.
#
# Repository
#  https://github.com/ktye/i
#
# TIO-version
#  https://github.com/ktye/i/blob/master/_/tio
#
# Sample program
#  ./k < hello.k
#
# Requirements for building the tio version:
#  go-1.13
#  ../../k.go must exist (should, if this is a git checkout)
#  git (for compiling the revision into the binary)
# Then run
#  sh readme

set -e
set -x
cp ../../k.go .
rev=$(git rev-parse --short HEAD)
printf "module github.com/ktye/i/_/k\n\ngo 1.13" > go.mod
GOPATH="" GO111MODULE=on GOOS=linux GOARCH=amd64 go build -ldflags="-s -w -X main.V=$rev"
echo "tio executable: k"
