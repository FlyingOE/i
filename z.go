package main

import . "github.com/ktye/wg/module"

func zk() {
	Data(600, "/32 40 48   56 64   72  80   88   96    104   112                       200   208    216    224    232\n `k`l`while`in`find`abs`imag`conj`angle`solve`dot`a`b`c`d`e`f`g`h`i`j`\".kst\"`\".lst\"`\".qr\"`\".slv\"`\".dot\"\n\n`\".kst\":{t:@x;n:#x;k:(.`\".kst\")[;y];m:y\n q:{c,x,c:_34}\n a:{x:$x;$[`c~t;q x;`s~t;\"`\",x;x]}\n d:{r:\"!\",k@.x;n:#!x;x:k@!x;$[(1~n)|(@.x)in`D`T;\"(\",x,\")\";x],r}\n v:{m*:(.`\".kstm\")t;  dd:(\"\";\"..\")m<#x;x:(m&#x)#x\n  x:$[`L~t;k'x;`C~t;x;$x]\n  x:$[`B~t;(*'x),\"b\";`C~t;q x;`S~t;c,(c:\"`\")/:x;`L~t;$[1~n;*x;\"(\",(\";\"/:x),\")\"];\" \"/:x]\n  ((\"\";\",\")(1~n)),x,dd}\n $[n~0;(.`\".kst0\")@t;`T~t;\"+\",d@+x;`D~t;d x;x~*x;a x;v x]}\n`\".kst0\":`B`C`I`S`F`Z`L!(\"0#0b\";c,c:_34;\"!0\";\"0#`\";\"0#0.\";\"0#0a\";\"()\")\n`\".kstm\":`B`C`I`S`F`Z`L!100 100 30 30 20 10 20\n\n`\".lst\":{t:@x;pad:{(|/#'x)#'x};lst:.`\".lst\";k:(.`\".kst\")[;1]\n kt:{x:$[`T~@x;T x;pad (\"\";\"-\"),$x];(x,'\"|\"),'T y}\n d:{r:!x;x:.x;$[`T~@x;kt[r;x];,'[,'[pad(k'r);\"|\"];k'x]]}\n T:{(,*x),(,(#*x)#\"-\"),1_x:\" \"/:'+pad'$(!x),'.x}\n dd:(\"\";,\"..\")20<#x\n x:$[x~*x;x;(20&#x)#x]\n $[`L~t;k'x;`D~t;d x;`T~t;T x;,k x],dd}\n\n`\".dotmv\":{{+/x*y}\\:[x;y]}\n`\".dot\":{f:.`\".dotmv\";f[x;y]}\n\n`\".slv\":{q:$[`i~@*|x;x;(.`\".qr\")@x];s:.`\".qslv\";$[`L~@y;s/:[q;y];s[q;y]]}\n\n`\".qslv\":{H:x 0;r:x 1;n:x 2;m:x 3;j:0;K:!m\n while[j<n;y[K]-:(+/(conj H[j;K])*y K)*H[j;K];K:1_K;j+:1]\n i:n-1;J:!n;y[i]%:r@i\n while[i;j:i_J;i-:1;y[i]:(y[i]-+/H[j;i]*y@j)%r@i]\n n#y}\n\n`\".qr\":{K:!m:#*x;I:!n:#x;j:0;r:n#0a;turn:$[`Z~@*x;{(-x)angle angle y};{x*1. -1@y>0}]\n while[j<n;I:1_I\n  r[j]:turn[s:0. abs/j_x j;xx:x[j;j]]\n  x[j;j]-:r[j]\n  x[j;K]%:%s*(s+abs xx)\n  x[I;K]-:{+/x*y}/:[(conj x[j;K]);x[I;K]]*\\:x[j;K]\n  K:1_K;j+:1];(x;r;n;m)}\n")
	zn := int32(1598) // should end before 4k
	x := mk(Ct, zn)
	Memorycopy(int32(x), 600, zn)
	dx(Val(x))
}
